<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>运行日志</title>
##	<link rel="stylesheet" href="../../static/css/jqueryui/base/jquery.ui.all.css"/>
##    <link rel="stylesheet" href="../../static/third/easyui/themes/insdep/easyui.css"></link>
##    <link rel="stylesheet" href="../../static/third/easyui/themes/insdep/icon.css"></link>
##    <link rel="stylesheet" href="../../static/css/msg.css"></link>
##    <link rel="stylesheet" type="text/css" href="../../static/third/easyui/themes/gray/easyui.css"/>
##    <link rel="stylesheet" href="../../static/css/reset.css"></link>
##	<script src="../../static/third/jquery-1.8.3.min.js"></script>
##    <script src="../../static/third/easyui/jquery.easyui.min.js"></script>
##    <script src="../../static/third/easyui/locale/easyui-lang-zh_CN.js"></script>
    <link rel="stylesheet" href="/static/third/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/third/adminlte/css/AdminLTE.min.css">
    <link rel="stylesheet" href="/static/third/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/third/easyui/themes/insdep/easyui.css">
    <link rel="stylesheet" href="/static/third/easyui/themes/insdep/easyui_animation.css">
    <link rel="stylesheet" href="/static/third/easyui/themes/insdep/easyui_plus.css">
    <link rel="stylesheet" href="/static/third/easyui/themes/insdep/icon.css">
    <link rel="stylesheet" href="/static/css/common.css">
    <script src="/static/third/jquery.js"></script>
    <script src="/static/third/bootstrap/js/bootstrap.min.js"></script>
    <script src="/static/third/easyui/jquery.easyui.min.js"></script>
    <script src="/static/third/easyui/themes/insdep/jquery.insdep-extend.min.js"></script>
    <script src="/static/third/easyui/locale/easyui-lang-zh_CN.js"></script>
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/easyui-extention_ws.js"></script>
    <script src="/static/js/customConfig.js"></script>
</head>

<body>
<div class="easyui-layout" data-options="fit : true,border : false">
	<div data-options="region:'north',border:false" style="height: 160px;overflow: auto;" align="left" class="new-form-box">
	
		<div style="line-height: inherit">
		    <a href="/Job/PageJump" class="easyui-linkbutton" iconCls="icon-th">任务列表</a>
		    <a href="/Job/JobLog" class="easyui-linkbutton" iconCls="icon-th">运行日志</a>
            <a href="/vehicle/InterfaceLog" class="easyui-linkbutton" iconCls="icon-th">整车接口日志</a>
            <a href="/purchase/InterfaceLog" class="easyui-linkbutton" iconCls="icon-th">采购接口日志</a>
		</div>
	
		<form id="filterForm" action="#">
	    	<table>
	    		<tr>
	    			<h2>Job日志</h2>
	    			<td>日志Id</td>
	    			<td><input id="logId"  name="logId" class="easyui-textbox"/></td>
	    			<td>状态</td>
	    			<td>
		    			<select id="status" name="status" class="easyui-combobox">
		    				<option value="1">启用</option>
		    				<option value="-1">停用</option>
		    			</select>
	    			</td>
	    			<td>开始时间
	    				<input id="startTime" name="startTime" type="text" class= "easyui-datebox" required ="required"/>
					</td>
	    			<td>结束时间
	    				<input id="endTime" name="endTime" type="text" class= "easyui-datebox" required ="required"/>
	    			</td>
	    			<td>
		    			<a id='search' href="#" class="easyui-linkbutton new-l-btn" iconCls="icon-search">查询</a>
	    			</td>
	    		</tr>
	    	</table>
	    </form>
    </div>
    <div data-options="region:'center',border:false">
		    <table id="dataGrid"></table>
		    <div id="msgMask"></div>
##			<div id="msg">正在处理，请稍待。。。</div>
	</div>
</div>

<script type="application/javascript">

$(function(){
   var curr_time = new Date();
   var strDate = curr_time.getFullYear()+"-";
   strDate += curr_time.getMonth()+1+"-";
   strDate += curr_time.getDate()+"-";
   strDate += curr_time.getHours()+":";
   strDate += curr_time.getMinutes()+":";
   strDate += curr_time.getSeconds();
   $("#startTime").datebox("setValue", strDate);
   $("#endTime").datebox("setValue", strDate); 
  });

//点击查询
$('#search').click(function () {
	var datagrid;
	//检索列表构筑
	if(datagrid){
		//grid刷新
	    $('#dataGrid').datagrid('load',{
	    	
	   	 });
	}else{
		//生成grid
	    datagrid = $('#dataGrid').datagrid({
	        url: "/Job/findJobLog",
	        fit: true,
	        pagination: true,
	        singleSelect: false,
	        checkOnSelect:true,
	        pageSize: 100,
	        pageList: [1,2,100,200,300],
	        nowrap: false,
	        rownumbers: true,
	        queryParams: {
	        	logId: $("#logId").val(),
	        	sysStatus: $("#status").val(),
	        	startTime: $("#startTime").val(),
	        	endTime: $("#endTime").val()
	        },
	        columns: [
	            [
	            	{field:'logId', title:'序号', width:'100', align:'center'},
	            	{field:'logId', title:'日志ID', width:'100', align:'center'},
			        {field:'startTime', title:'开始时间', width:'100', align:'center',
	                    formatter : function(value) {
	                        var date = new Date(value);
	                        var year = date.getFullYear().toString();
	                        var month = (date.getMonth() + 1);
	                        var day = date.getDate().toString();
	                        var hour = date.getHours().toString();
	                        var minutes = date.getMinutes().toString();
	                        var seconds = date.getSeconds().toString();
	                        if (month < 10) {
	                            month = "0" + month;
	                        }
	                        if (day < 10) {
	                            day = "0" + day;
	                        }
	                        if (hour < 10) {
	                            hour = "0" + hour;
	                        }
	                        if (minutes < 10) {
	                            minutes = "0" + minutes;
	                        }
	                        if (seconds < 10) {
	                            seconds = "0" + seconds;
	                        }
	                        return year + "-" + month + "-" + day + " " + hour + ":" + minutes + ":" + seconds;
	                    }
			        },
			        {field:'endTime', title:'结束时间', width:'100', align:'center',
	                    formatter : function(value) {
	                        var date = new Date(value);
	                        var year = date.getFullYear().toString();
	                        var month = (date.getMonth() + 1);
	                        var day = date.getDate().toString();
	                        var hour = date.getHours().toString();
	                        var minutes = date.getMinutes().toString();
	                        var seconds = date.getSeconds().toString();
	                        if (month < 10) {
	                            month = "0" + month;
	                        }
	                        if (day < 10) {
	                            day = "0" + day;
	                        }
	                        if (hour < 10) {
	                            hour = "0" + hour;
	                        }
	                        if (minutes < 10) {
	                            minutes = "0" + minutes;
	                        }
	                        if (seconds < 10) {
	                            seconds = "0" + seconds;
	                        }
	                        return year + "-" + month + "-" + day + " " + hour + ":" + minutes + ":" + seconds;
	                    }
			        },
			        {field:'NextTime', title:'下一次运行时间', width:'100', align:'center',
	                    formatter : function(value) {
	                        var date = new Date(value);
	                        var year = date.getFullYear().toString();
	                        var month = (date.getMonth() + 1);
	                        var day = date.getDate().toString();
	                        var hour = date.getHours().toString();
	                        var minutes = date.getMinutes().toString();
	                        var seconds = date.getSeconds().toString();
	                        if (month < 10) {
	                            month = "0" + month;
	                        }
	                        if (day < 10) {
	                            day = "0" + day;
	                        }
	                        if (hour < 10) {
	                            hour = "0" + hour;
	                        }
	                        if (minutes < 10) {
	                            minutes = "0" + minutes;
	                        }
	                        if (seconds < 10) {
	                            seconds = "0" + seconds;
	                        }
	                        return year + "-" + month + "-" + day + " " + hour + ":" + minutes + ":" + seconds;
	                    }
			        },
			        {field:'sysStatus', title:'系统状态', width:'100', align:'center'
			        },
			        {field:'bizStatus', title:'业务状态', width:'100', align:'center'},
			        {field:'message', title:'备注', width:'300', align:'center'}
	            ]
	        ]
	    });
	}
    $('#dataGrid').parent().find("div.datagrid-header-check").children("input[type='checkbox']").eq(0).attr("checked", false);
});

</script>
</body>
</html>